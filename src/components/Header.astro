---
import Badge from "@components/Badge";
---

<div
  id="header"
  class="fixed top-0 z-40 flex items-center justify-center w-full h-40 border-b border-transparent bg-black/70 select-none duration-500 mr-10 ml-10"
>
  <div class="container flex justify-between">
    <div class="flex items-center justify-start space-x-[50px]">
      <a id="logo" href="/" class="relative group">
        <img
          alt="bliss logo"
          src="/assets/bliss-logo.png"
          height={80}
          width={80}
        />
        <p
          class="absolute left-0 right-0 mx-auto text-sm font-medium text-center opacity-0 bg-accent-dark text-accent rounded-md group-hover:opacity-100 transition-opacity duration-300"
        >
          Home
        </p>
      </a>
    </div>
    <div id="menu" class="flex items-center space-x-4 md:space-x-7 pl-4 md:pl-0">
      <a
        id="speakerSeriesLink"
        href="/"
        class="hidden md:block tracking-wider no-underline text-secondary hover:text-primary transition-colors"
      >
        <p class="text-center">Speaker Series</p>
      </a>
      <a
        id="readingGroupLink"
        href="/reading-group"
        class="tracking-wider no-underline text-secondary hover:text-primary transition-colors"
      >
        <p class="text-center">Reading Group</p>
      </a>
      <a
        id="workshopsLink"
        href="/workshops"
        class="tracking-wider no-underline text-secondary hover:text-primary transition-colors"
      >
        <p class="text-center">Workshops</p>
      </a>
      <a
        id="pastEventsLink"
        href="/past-events"
        class="tracking-wider no-underline text-secondary hover:text-primary transition-colors"
      >
        <p class="text-center">Past Events</p>
      </a>
      <a
        id="teamLink"
        href="/team"
        class="tracking-wider no-underline text-secondary hover:text-primary transition-colors"
      >
        <p>Team</p>
      </a>
    </div>
  </div>
</div>

<style>
  #join-link:hover {
    text-decoration-color: transparent;
  }
</style>

<script>
  let windowWidth = window.innerWidth;

  // header
  const header = document.getElementById("header")!;

  // link animation
  const speakerSeriesLink: HTMLElement = document.getElementById("speakerSeriesLink")!;
  const readingGroupLink: HTMLElement = document.getElementById("readingGroupLink")!;
  const workshopsLink: HTMLElement = document.getElementById("workshopsLink")!;
  const pastEventsLink: HTMLElement = document.getElementById("pastEventsLink")!;
  const teamLink: HTMLElement = document.getElementById("teamLink")!;
  const allLinks: HTMLElement[] = [speakerSeriesLink, readingGroupLink, workshopsLink, pastEventsLink];

  function animateHeader() {
    if (window.scrollY > 0) {
      header.classList.remove("h-40");
      header.classList.add("h-20");
      header.classList.add("backdrop-blur-md");
      header.classList.add("border-border");
      header.classList.remove("border-transparent");
    } else {
      header.classList.remove("h-20");
      header.classList.add("h-40");
      header.classList.remove("backdrop-blur-md");
      header.classList.remove("border-border");
      header.classList.add("border-transparent");
    }
  }

  function setActiveLink(activeLink: HTMLElement | null) {
    // Reset all links to secondary
    allLinks.forEach(link => {
      link.classList.remove("text-primary");
      link.classList.add("text-secondary");
    });

    // Set active link to primary
    if (activeLink) {
      activeLink.classList.remove("text-secondary");
      activeLink.classList.add("text-primary");
    }
  }

  function handleRoute() {
    // Set active link based on URL path
    const linkMap = {
      "/": speakerSeriesLink,
      "/reading-group": readingGroupLink,
      "/workshops": workshopsLink,
      "/past-events": pastEventsLink,
      "/team": teamLink,
    }
    setActiveLink(linkMap[window.location.pathname as keyof typeof linkMap]);
  }

  function handleScroll() {
    animateHeader();
  }

  function handleResize() {
    windowWidth = window.innerWidth;
  }

  animateHeader();
  handleRoute();
  document.addEventListener("scroll", handleScroll);
  document.addEventListener("resize", handleResize);
</script>